# Модельный веб сервер

Я сделал веб-сервер который умеет отдавать статику и выполнять CGI-программы.
Запросы обрабатываюся асинхронно.
API был навеен популярным фреймворком [expressjs](https://github.com/expressjs/express).
 
### Установка и запуск
Для компиляции и запуска можно использовать makefile.

```sh
$ make
$ make run
```

### Пример использования
Когда мы формируем наш сервер, можем в качестве параметра передать номер порта и имя файла для логов. По умолчанию сервер рабоает на 8080 порте и пишет логи в "log.txt".

```cpp
#include "http_server.h"

int main(){
    Server app(3000, "logFile.txt");
    app.Get("/", "test1.html");
    app.Get("/hello", "test2.html"); //файла не существует, получаем ответ 500
    app.use("cgi-bin"); //Дирректория с CGI-программами
    app.run();
    return 0;
}
```
### CGI
Я добавил поддержку CGI. Для этого нужно при формировании нашего сервера указать следующую инструкицию: 
```
app.use("cgi-bin"); //или другое желаемое имя папки вместо cgi-bin
```
При запросе к /test будет выполнена проверка на наличие этого маршрута в списке статических. Если такового маршрута нет, то в указанной папке с CGI-программами будет выполнен поиск программы с именем "test", а затем и её запуск с перенаправлением вывода в сокет. Если программы нет, то сервер вернет 404.

### Обработка ошибок
![](https://i.ibb.co/kSKtC7R/2020-04-10-0-15-50.png)

> Попытка совершить запрос к необъявленному маршруту. Ответ: 404

![](https://i.ibb.co/MpgjvPH/2020-04-10-0-15-58.png)
> Попытка выполнить POST запрос. Ответ: 501

![](https://i.ibb.co/5sk5bNX/2020-04-11-20-38-52.png)
>Пытаемся открыть /hello, но файл test2.html не существует на сервере. Ответ: 500